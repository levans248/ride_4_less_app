
<div class="ride_info">
  <%= form_tag '/ride_details', method: :post do %>
    <div>
      <%= text_field_tag :origin, "Pickup Location", :class=>"address_details" %>    
    </div>
    <div>
      <%= text_field_tag :destination, "Dropoff Location", :class=>"address_details" %>    
    </div>
      <%= submit_tag "GET RIDE INFO", :id=>"request-info" %>
  <% end %>
</div>

<% if params[:commit] %>
  <div class="uber_info wrapper" >
    <p id= "uber_map_title">Uber:</p>
    <ul class="uber_ride_details">
      <li class="list_spacing">Car Type: <%=@estimations[0].display_name%></li> 
      <% if @estimations[0].surge_multiplier > 1 %>
        <li class="list_spacing">Surging: <%=@estimations[0].surge_multiplier%> (<a href="/ride_details/surge_view?orgin=<%=@origin%>&destination=<%=@destination%>">view map of surge </a>)</li>
      <% else %>
        <li class="list_spacing">Surging: No (<a href="/ride_details/surge_view?orgin=<%=@origin%>&destination=<%=@destination%>">view map of surge </a>)</li>
      <% end %>  
      <li class="list_spacing">Price Estimate: <%=@estimations[0].estimate%></li>
      <li class="list_spacing">Distance: <%=@estimations[0].distance%> miles</li>
      <li class="list_spacing">Approximate Trip Duration: <%=(@estimations[0].duration.to_f/60).ceil %> minutes</li>
    </ul>
    <div id = "uber_map"></div>
  </div>

  <div class= "bus_info wrapper">
    <p id= "transit_map_title">Transit:</p>
    <ul class="bus_ride_details">
      <li class="list_spacing">Ride Type: Public Transit</li> 
      <li class="list_spacing">Surging: Never</li>
      <% if @google_bus_data["rows"][0]["elements"][0].include? "fare" %>
        <li class="list_spacing">Price Estimate: <%= @google_bus_data["rows"][0]["elements"][0]["fare"]["text"]%></li>
      <% else %>
        <li class="list_spacing">Price Estimate: Pricing Unavailable</li>
      <% end %>  
      <li class="list_spacing">Distance: <%= @google_bus_data["rows"][0]["elements"][0]["distance"]["text"] %></li>
      <li class="list_spacing">Approximate Trip Duration: <%= @google_bus_data["rows"][0]["elements"][0]["duration"]["text"] %></li>
    </ul>
    <div id = "bus_map"></div>
  </div>


  <script src="http://maps.google.com/maps/api/js?sensor=false">
  </script>

  <script  type="text/javascript" >
    // for uber map
    var directionsService = new google.maps.DirectionsService();
    var directionsDisplay = new google.maps.DirectionsRenderer();
    
    // for bus map
    var directionsService2 = new google.maps.DirectionsService();
    var directionsDisplay2 = new google.maps.DirectionsRenderer();

    // creates the two maps
    var map = new google.maps.Map(document.getElementById('uber_map'), {
      zoom:7,
      center: {lat: <%= @origin[0]%>, lng: <%= @origin[1]%>}, 
      mapTypeId: google.maps.MapTypeId.ROADMAP
    });

    var map2 = new google.maps.Map(document.getElementById('bus_map'), {
      zoom:7,
      center: {lat: <%= @origin[0]%>, lng: <%= @origin[1]%>},
      mapTypeId: google.maps.MapTypeId.ROADMAP
    });

    // sets directions on both maps
    directionsDisplay.setMap(map);
    directionsDisplay2.setMap(map2);

    // specify direction details for each map
    var uberRequest = {
      origin: {lat: <%= @origin[0]%>, lng: <%= @origin[1]%>}, 
      destination: {lat: <%=@destination[0]%>, lng: <%=@destination[1]%>},
      travelMode: google.maps.DirectionsTravelMode.DRIVING
    };

    var busRequest = {
      origin: {lat: <%= @origin[0]%>, lng: <%= @origin[1]%>}, 
      destination: {lat: <%=@destination[0]%>, lng: <%=@destination[1]%>},
      travelMode: google.maps.DirectionsTravelMode.TRANSIT
    };

    // put the direction line onto each map
    directionsService.route(uberRequest, function(response, status) {
      if (status == google.maps.DirectionsStatus.OK) {
        directionsDisplay.setDirections(response);
      } else {
        alert("Uber directions failed: " + status)
      }
    });

    directionsService.route(busRequest, function(response, status) {
      if (status == google.maps.DirectionsStatus.OK) {
        directionsDisplay2.setDirections(response);
      } else {
        alert("Bus directions failed: " + status)
      }
    });



    
  </script>

<%end%>
      














 

 